experiment:
  server:
    hostname: thinkpad
    cpu_description: AMD Ryzen 5 5500U
    hertz: 2.1
    cores: 6
    threads: 12
    ram_memory: 16
    operating_system: Ubuntu 25.04
  benchmarks:
    - name: '2mm' 
      version: 0
      path: ./applications/2mm
      setup: 'mkdir -p $PATH/output'
      description: 'Multiply two matrixes with this result multiply with another matrix and output the result as a csv like structure (without the header).'
  executions:
    - bench_name: 2mm
      bench_version: 0
      num_executions: 1
      num_threads: [1]
      inputs:
        matrix_size: 256
        output: output.csv
      variants:
        - type: common
          compile: 'make -C $PATH'
          pos-processing: "duckdb -c \"COPY (SELECT * FROM read_csv_auto('output.csv')) TO '$PATH/output/output_$ID_RUN.parquet' (FORMAT PARQUET);\" && rm -f output.csv"
          baseline: true
          env_vars:
            OMP_PROC_BIND: "TRUE"
        - type: omp
          compile: 'make NUM_THREADS=$NUM_THREADS -C $PATH omp'
          pos-processing: "duckdb -c \"COPY (SELECT * FROM read_csv_auto('output.csv')) TO '$PATH/output/output_$ID_RUN.parquet' (FORMAT PARQUET);\" && rm -f output.csv"
          metric:
            type: MAPE
            reference: $PATH/output/output_$ID_BASE.parquet
            prediction: $PATH/output/output_$ID_RUN.parquet
          env_vars:
            OMP_PROC_BIND: "TRUE"